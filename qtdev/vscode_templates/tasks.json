{
    // See https://go.microsoft.com/fwlink/?LinkId=733558 
    // for the documentation about the tasks.json format
    "version": "2.0.0",
	"tasks": [		
		{
			"label": "Build Essentials",
			"presentation": {
				"echo": false,
				"revealProblems": "onProblem",
				"focus": false,
				"panel": "dedicated",
				"showReuseMessage": false,
				"clear": true,
				"group": "build"
			},
			"type": "shell",
			"command": "build_modules",
			"group": "build",
			"problemMatcher": {
				"owner": "cpp",
				"fileLocation": [
					"autoDetect",
					"${workspaceFolder}"
				],
				"pattern": {
					"regexp": "^(.*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
					"file": 1,
					"line": 2,
					"column": 3,
					"severity": 4,
					"message": 5
				}
			}
		},
        {
            "label": "Build current",
            "presentation": {
                "echo": false,
                "revealProblems": "onProblem",
                "focus": false,
                "panel": "shared",
                "showReuseMessage": true,
                "clear": true,
                "group": "build"
            },
            "type": "shell",
            "command": "PROJECT=$(echo ${relativeFileDirname} | awk -F/ '{print $1}'); cd ${PROJECT}-build; echo \"Building $PROJECT...\"; ninja src/all",
            "group": {
                "kind": "build",
                "isDefault": true
            },
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": {
                "owner": "cpp",
                "fileLocation": [
                    "autoDetect",
                    "${workspaceFolder}"
                ],
                "pattern": {
                    "regexp": "^(.*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
                    "file": 1,
                    "line": 2,
                    "column": 3,
                    "severity": 4,
                    "message": 5
                }
            }
		},
		{
			"label": "build qtbase/src",
			"presentation": {
				"echo": false,
				"revealProblems": "onProblem",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": true,
				"group": "qtbase"
			},
			"type": "shell",
			"options": {
				"cwd": "qtbase-build"
			},
			"command": "if [ -f build.ninja ]; then ninja src/all; else make sub-src -j8; fi",
			"group": {
				"kind": "build",
				"isDefault": true
			},
			"problemMatcher": {
				"owner": "cpp",
				"fileLocation": [
					"autoDetect",
					"${workspaceFolder}"
				],
				"pattern": {
					"regexp": "^(.*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
					"file": 1,
					"line": 2,
					"column": 3,
					"severity": 4,
					"message": 5
				}
			}
		},
		{
			"label": "build qtbase/all",
			"presentation": {
				"echo": false,
				"revealProblems": "onProblem",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": true,
				"group": "qtbase"
			},
			"type": "shell",
			"options": {
				"cwd": "qtbase-build"
			},
			"command": "if [ -f build.ninja ]; then ninja; else make -j8 > /dev/null; fi",
			"group": "build",
			"problemMatcher": {
				"owner": "cpp",
				"fileLocation": [
					"autoDetect",
					"${workspaceFolder}"
				],
				"pattern": {
					"regexp": "^(.*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
					"file": 1,
					"line": 2,
					"column": 3,
					"severity": 4,
					"message": 5
				}
			}
		},
		{
			"label": "test qtbase",
			"presentation": {
				"echo": false,
				"revealProblems": "onProblem",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": true,
				"group": "qtbase"
			},
			"type": "process",
			"options": {
				"cwd": "qtbase-build"
			},
			"command": "ctest",
			"group": {
				"kind": "test",
				"isDefault": true
			}
		},
		{
			"label": "clean qtbase",
			"presentation": {
				"echo": false,
				"revealProblems": "onProblem",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": true,
				"group": "qtbase"
			},
			"type": "shell",
			"options": {
				"cwd": "qtbase-build"
			},
			"command": "if [ -f build.ninja ]; then ninja clean; else make clean -j8; fi > /dev/null",
			"group": "build",
			"problemMatcher": {
				"owner": "cpp",
				"fileLocation": [
					"autoDetect",
					"${workspaceFolder}"
				],
				"pattern": {
					"regexp": "^(.*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
					"file": 1,
					"line": 2,
					"column": 3,
					"severity": 4,
					"message": 5
				}
			}
		},
		{
			"label": "configure",
			"presentation": {
				"echo": true,
				"revealProblems": "onProblem",
				"focus": false,
				"panel": "shared",
				"showReuseMessage": true,
				"clear": true,
				"group": "qtbase"
			},
			"type": "shell",
			"options": {
				"cwd": "qtbase-build"
			},
			"command": "rm CMakeCache.txt && ../qtbase/configure -developer-build -opensource -confirm-license -cmake",
			"group": "build",
			"problemMatcher": {
				"owner": "cpp",
				"fileLocation": [
					"autoDetect",
					"${workspaceFolder}"
				],
				"pattern": {
					"regexp": "^(.*):(\\d+):(\\d+):\\s+(warning|error):\\s+(.*)$",
					"file": 1,
					"line": 2,
					"column": 3,
					"severity": 4,
					"message": 5
				}
			}
		}
    ]
}